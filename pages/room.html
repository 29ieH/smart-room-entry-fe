<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Danh sách phòng</title>
      <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="manifest" href="../setup/manifest.json" />
<meta name="theme-color" content="#2563eb" />
<link rel="icon" href="../public/images/icon_192x192.png" type="image/png" />
  </head>

  <body class="bg-gray-50 flex flex-col md:flex-row h-screen text-gray-800">
    <!-- SIDEBAR -->
    <aside
      id="sidebar"
      class="w-64 bg-gradient-to-b from-blue-600 to-indigo-700 text-white flex flex-col fixed md:static inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition-transform duration-300 z-50"
    >
      <div
        class="px-6 py-5 flex items-center space-x-2 text-xl font-semibold border-b border-white/10"
      >
        <i class="fa-solid fa-building-user text-white"></i>
        <span>SMART COUNTER</span>
        <button
          id="closeSidebarBtn"
          class="ml-auto md:hidden text-white hover:text-gray-200"
        >
          <i class="fa-solid fa-xmark text-lg"></i>
        </button>
      </div>

      <nav class="flex-1 px-4 py-6 space-y-2">
        <a
          href="/smart-room-entry-fe/pages/log-access.html"
          class="flex items-center px-4 py-2 rounded-lg hover:bg-white/10 transition"
        >
          <i class="fa-solid fa-clock-rotate-left mr-3"></i> Lịch sử ra vào
        </a>
        <a
          href="/smart-room-entry-fe/pages/room.html"
          class="flex items-center px-4 py-2 rounded-lg bg-white/10 transition"
        >
          <i class="fa-solid fa-door-open mr-3"></i> Phòng
        </a>
        <a
          href="#"
          class="flex items-center px-4 py-2 rounded-lg hover:bg-white/10 transition"
        >
          <i class="fa-solid fa-gear mr-3"></i> Cài đặt
        </a>
      </nav>
    </aside>

    <!-- MAIN -->
    <div class="flex-1 flex flex-col">
      <!-- HEADER -->
      <header
        class="flex justify-between items-center bg-white px-6 py-3 shadow-sm border-b"
      >
        <div class="flex items-center gap-3">
          <!-- Nút mở menu -->
          <button
            id="menuToggleBtn"
            class="md:hidden text-gray-600 hover:text-blue-600"
          >
            <i class="fa-solid fa-bars text-2xl"></i>
          </button>
          <h2 class="text-lg font-semibold md:hidden">Danh sách phòng</h2>
        </div>

        <div class="flex items-center space-x-6 relative">
          <button id="notifyBtn" class="relative">
            <i
              class="fa-regular fa-bell text-gray-600 text-xl hover:text-blue-600"
            ></i>
            <span
              id="notifyCount"
              class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1"
              >0</span
            >
          </button>

          <div
            id="notifyList"
            class="absolute right-0 mt-10 w-80 bg-white shadow-xl rounded-lg hidden max-h-96 overflow-y-auto border border-gray-200 z-50 top-2"
          >
            <div id="notifyContainer" class="divide-y divide-gray-100"></div>
            <div id="loading" class="text-center py-2 text-gray-500 hidden">
              Đang tải...
            </div>
          </div>

          <div class="relative">
            <button
              id="userMenuBtn"
              class="flex items-center space-x-2 focus:outline-none"
            >
              <img
                src="../public/images/avatar_default.png"
                class="w-9 h-9 rounded-full border"
                alt="User"
              />
              <div class="hidden sm:block">
                <p id="accountName" class="font-medium">Unknown</p>
                <p id="accountRole" class="text-sm text-gray-500">Unknown</p>
              </div>
              <i
                class="fa-solid fa-chevron-down text-gray-500 text-sm hidden sm:block"
              ></i>
            </button>

            <div
              id="userDropdown"
              class="absolute right-0 mt-2 w-44 bg-white rounded-lg shadow-lg border hidden"
            >
              <ul class="text-gray-700">
                <li>
                  <a
                    href="#"
                    class="block px-4 py-2 hover:bg-gray-100"
                    ><i class="fa-solid fa-user mr-2"></i>Trang cá nhân</a
                  >
                </li>
                <li>
                  <button
                    id="logoutBtn"
                    class="w-full text-left px-4 py-2 hover:bg-gray-100"
                  >
                    <i class="fa-solid fa-right-from-bracket mr-2"></i>Đăng xuất
                  </button>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </header>

      <!-- MAIN CONTENT -->
      <main class="p-6 overflow-y-auto flex-1 space-y-6">
        <h2 class="text-2xl font-semibold mb-6 hidden md:block">
          Thông tin phòng
        </h2>

        <!-- Bộ lọc (ẩn trên mobile) -->
        <div class="bg-white p-4 rounded-2xl shadow-md">
          <div class="flex justify-between items-center mb-3 lg:hidden">
            <h2 class="text-lg font-semibold text-gray-800">Bộ lọc</h2>
            <button
              id="toggleFilterBtn"
              class="text-blue-600 hover:text-blue-800 focus:outline-none p-2 rounded-full hover:bg-blue-50 transition"
            >
              <i id="toggleIcon" class="fa-solid fa-filter text-lg"></i>
            </button>
          </div>

          <div
            id="filterContainer"
            class="flex flex-col lg:flex-row lg:items-center gap-4 transition-all duration-300 overflow-hidden lg:max-h-full lg:opacity-100 lg:visible max-h-0 opacity-0 invisible"
          >
            <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2">
              <label for="searchBoxLog" class="text-sm text-gray-700"
                >Tìm kiếm:</label
              >
              <input
                id="searchBoxLog"
                type="text"
                placeholder="Nhập mã phòng..."
                class="px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-400 w-full sm:w-80"
              />
            </div>

            <div
              class="flex flex-col sm:flex-row items-start sm:items-center gap-2"
            >
              <label for="pageSizeSelect" class="text-sm text-gray-700"
                >Số lượng dòng:</label
              >
              <select
                id="pageSizeSelect"
                class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 w-full sm:w-auto"
              >
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="40">40</option>
                <option value="60">60</option>
                <option value="100">100</option>
              </select>
            </div>
          </div>
        </div>

        <!-- TABLE (PC) -->
        <div
          class="overflow-x-auto bg-white rounded-2xl shadow-md hidden md:block"
        >
          <table class="min-w-full text-sm text-left border-collapse">
            <thead class="bg-gray-100 text-gray-700 uppercase">
              <tr>
                <th class="px-6 py-3">ID</th>
                <th class="px-6 py-3">Mã phòng</th>
                <th class="px-6 py-3 text-center">Số người hiện tại</th>
                <th class="px-6 py-3 text-center">Số người quy định</th>
                <th class="px-6 py-3 text-center">Trạng thái</th>
                <th class="px-6 py-3 text-center">Thao tác</th>
              </tr>
            </thead>
            <tbody id="historyTableBody" class="divide-y divide-gray-200">
              <!-- Render bằng JS -->
            </tbody>
          </table>
        </div>

        <!-- CARD (MOBILE/TABLET) -->
        <div
          id="cardContainer"
          class="grid grid-cols-1 sm:grid-cols-2 gap-4 md:hidden"
        >
          <!-- Render bằng JS -->
        </div>

        <div
          id="pagination"
          class="flex items-center justify-center gap-2 mt-6 select-none"
        ></div>
      </main>
 <div id="logPopup" class="fixed top-20 right-5 hidden w-80 bg-white shadow-lg border border-gray-200 rounded-lg p-4 z-50">
  <div class="flex justify-between items-start cursor-pointer">
    <div>
      <p class="text-gray-800 font-semibold">Thông báo mới</p>
      <p id="logMessage" class="text-gray-600 text-sm mt-1">Nội dung log sẽ hiển thị ở đây.</p>
    </div>
    <button id="closePopup" class="text-gray-400 hover:text-gray-600 ml-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 8.586l4.95-4.95a1 1 0 111.414 1.414L11.414 10l4.95 4.95a1 1 0 01-1.414 1.414L10 11.414l-4.95 4.95a1 1 0 01-1.414-1.414L8.586 10l-4.95-4.95a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd" />
      </svg>
    </button>
  </div>
    </div>
    <div id="spinnerOverlay" class="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center hidden z-50 transition-opacity duration-300">
      <div class="w-16 h-16 border-4 border-t-blue-500 border-gray-200 rounded-full animate-spin"></div>
    </div>
    <div id="updateModal" class="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg w-96 p-6 relative">
    <h3 id="modalTitle" class="text-lg font-semibold mb-4">Cập nhật số người</h3>
    <input id="modalInput" type="number" min="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none mb-4"/>
    <div class="flex justify-end gap-2">
      <button id="modalCancel" class="px-4 py-2 rounded-lg border hover:bg-gray-100">Hủy</button>
      <button id="modalSave" class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Lưu</button>
    </div>
    <button id="modalClose" class="absolute top-2 right-2 text-gray-400 hover:text-gray-600">
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
</div>
  </div>
  <div id="floatingMenu" class="hidden absolute z-50 w-48 bg-white shadow-lg rounded-lg border">
    <ul>...</ul>
  </div>
  <script src="../js/navigator.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="../js/auth.js"></script>
  <script src="../js/modal.js"></script>
  <script src="../js/rooms.js"></script>
  <script src="../js/notifications.js"></script>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    </div>
